define(["require", "exports", "react/jsx-runtime", "react", "recharts", "@/lib/utils"], function (require, exports, jsx_runtime_1, React, RechartsPrimitive, utils_1) {
    "use client";
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.ChartStyle = exports.ChartLegendContent = exports.ChartLegend = exports.ChartTooltipContent = exports.ChartTooltip = exports.ChartContainer = void 0;
    // Format: { THEME_NAME: CSS_SELECTOR }
    const THEMES = { light: "", dark: ".dark" };
    const ChartContext = React.createContext(null);
    function useChart() {
        const context = React.useContext(ChartContext);
        if (!context) {
            throw new Error("useChart must be used within a <ChartContainer />");
        }
        return context;
    }
    const ChartContainer = React.forwardRef(({ id, className, children, config, ...props }, ref) => {
        const uniqueId = React.useId();
        const chartId = `chart-${id || uniqueId.replace(/:/g, "")}`;
        return ((0, jsx_runtime_1.jsx)(ChartContext.Provider, { value: { config }, children: (0, jsx_runtime_1.jsxs)("div", { "data-chart": chartId, ref: ref, className: (0, utils_1.cn)("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none", className), ...props, children: [(0, jsx_runtime_1.jsx)(ChartStyle, { id: chartId, config: config }), (0, jsx_runtime_1.jsx)(RechartsPrimitive.ResponsiveContainer, { children: children })] }) }));
    });
    exports.ChartContainer = ChartContainer;
    ChartContainer.displayName = "Chart";
    const ChartStyle = ({ id, config }) => {
        const colorConfig = Object.entries(config).filter(([, config]) => config.theme || config.color);
        if (!colorConfig.length) {
            return null;
        }
        return ((0, jsx_runtime_1.jsx)("style", { dangerouslySetInnerHTML: {
                __html: Object.entries(THEMES)
                    .map(([theme, prefix]) => `
${prefix} [data-chart=${id}] {
${colorConfig
                    .map(([key, itemConfig]) => {
                    var _a;
                    const color = ((_a = itemConfig.theme) === null || _a === void 0 ? void 0 : _a[theme]) ||
                        itemConfig.color;
                    return color ? `  --color-${key}: ${color};` : null;
                })
                    .join("\n")}
}
`)
                    .join("\n"),
            } }));
    };
    exports.ChartStyle = ChartStyle;
    const ChartTooltip = RechartsPrimitive.Tooltip;
    exports.ChartTooltip = ChartTooltip;
    const ChartTooltipContent = React.forwardRef(({ active, payload, className, indicator = "dot", hideLabel = false, hideIndicator = false, label, labelFormatter, labelClassName, formatter, color, nameKey, labelKey, }, ref) => {
        const { config } = useChart();
        const tooltipLabel = React.useMemo(() => {
            var _a;
            if (hideLabel || !(payload === null || payload === void 0 ? void 0 : payload.length)) {
                return null;
            }
            const [item] = payload;
            const key = `${labelKey || (item === null || item === void 0 ? void 0 : item.dataKey) || (item === null || item === void 0 ? void 0 : item.name) || "value"}`;
            const itemConfig = getPayloadConfigFromPayload(config, item, key);
            const value = !labelKey && typeof label === "string"
                ? ((_a = config[label]) === null || _a === void 0 ? void 0 : _a.label) || label
                : itemConfig === null || itemConfig === void 0 ? void 0 : itemConfig.label;
            if (labelFormatter) {
                return ((0, jsx_runtime_1.jsx)("div", { className: (0, utils_1.cn)("font-medium", labelClassName), children: labelFormatter(value, payload) }));
            }
            if (!value) {
                return null;
            }
            return (0, jsx_runtime_1.jsx)("div", { className: (0, utils_1.cn)("font-medium", labelClassName), children: value });
        }, [
            label,
            labelFormatter,
            payload,
            hideLabel,
            labelClassName,
            config,
            labelKey,
        ]);
        if (!active || !(payload === null || payload === void 0 ? void 0 : payload.length)) {
            return null;
        }
        const nestLabel = payload.length === 1 && indicator !== "dot";
        return ((0, jsx_runtime_1.jsxs)("div", { ref: ref, className: (0, utils_1.cn)("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl", className), children: [!nestLabel ? tooltipLabel : null, (0, jsx_runtime_1.jsx)("div", { className: "grid gap-1.5", children: payload.map((item, index) => {
                        const key = `${nameKey || item.name || item.dataKey || "value"}`;
                        const itemConfig = getPayloadConfigFromPayload(config, item, key);
                        const indicatorColor = color || item.payload.fill || item.color;
                        return ((0, jsx_runtime_1.jsx)("div", { className: (0, utils_1.cn)("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground", indicator === "dot" && "items-center"), children: formatter && (item === null || item === void 0 ? void 0 : item.value) !== undefined && item.name ? (formatter(item.value, item.name, item, index, item.payload)) : ((0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [(itemConfig === null || itemConfig === void 0 ? void 0 : itemConfig.icon) ? ((0, jsx_runtime_1.jsx)(itemConfig.icon, {})) : (!hideIndicator && ((0, jsx_runtime_1.jsx)("div", { className: (0, utils_1.cn)("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]", {
                                            "h-2.5 w-2.5": indicator === "dot",
                                            "w-1": indicator === "line",
                                            "w-0 border-[1.5px] border-dashed bg-transparent": indicator === "dashed",
                                            "my-0.5": nestLabel && indicator === "dashed",
                                        }), style: {
                                            "--color-bg": indicatorColor,
                                            "--color-border": indicatorColor,
                                        } }))), (0, jsx_runtime_1.jsxs)("div", { className: (0, utils_1.cn)("flex flex-1 justify-between leading-none", nestLabel ? "items-end" : "items-center"), children: [(0, jsx_runtime_1.jsxs)("div", { className: "grid gap-1.5", children: [nestLabel ? tooltipLabel : null, (0, jsx_runtime_1.jsx)("span", { className: "text-muted-foreground", children: (itemConfig === null || itemConfig === void 0 ? void 0 : itemConfig.label) || item.name })] }), item.value && ((0, jsx_runtime_1.jsx)("span", { className: "font-mono font-medium tabular-nums text-foreground", children: item.value.toLocaleString() }))] })] })) }, item.dataKey));
                    }) })] }));
    });
    exports.ChartTooltipContent = ChartTooltipContent;
    ChartTooltipContent.displayName = "ChartTooltip";
    const ChartLegend = RechartsPrimitive.Legend;
    exports.ChartLegend = ChartLegend;
    const ChartLegendContent = React.forwardRef(({ className, hideIcon = false, payload, verticalAlign = "bottom", nameKey }, ref) => {
        const { config } = useChart();
        if (!(payload === null || payload === void 0 ? void 0 : payload.length)) {
            return null;
        }
        return ((0, jsx_runtime_1.jsx)("div", { ref: ref, className: (0, utils_1.cn)("flex items-center justify-center gap-4", verticalAlign === "top" ? "pb-3" : "pt-3", className), children: payload.map((item) => {
                const key = `${nameKey || item.dataKey || "value"}`;
                const itemConfig = getPayloadConfigFromPayload(config, item, key);
                return ((0, jsx_runtime_1.jsxs)("div", { className: (0, utils_1.cn)("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"), children: [(itemConfig === null || itemConfig === void 0 ? void 0 : itemConfig.icon) && !hideIcon ? ((0, jsx_runtime_1.jsx)(itemConfig.icon, {})) : ((0, jsx_runtime_1.jsx)("div", { className: "h-2 w-2 shrink-0 rounded-[2px]", style: {
                                backgroundColor: item.color,
                            } })), itemConfig === null || itemConfig === void 0 ? void 0 : itemConfig.label] }, item.value));
            }) }));
    });
    exports.ChartLegendContent = ChartLegendContent;
    ChartLegendContent.displayName = "ChartLegend";
    // Helper to extract item config from a payload.
    function getPayloadConfigFromPayload(config, payload, key) {
        if (typeof payload !== "object" || payload === null) {
            return undefined;
        }
        const payloadPayload = "payload" in payload &&
            typeof payload.payload === "object" &&
            payload.payload !== null
            ? payload.payload
            : undefined;
        let configLabelKey = key;
        if (key in payload &&
            typeof payload[key] === "string") {
            configLabelKey = payload[key];
        }
        else if (payloadPayload &&
            key in payloadPayload &&
            typeof payloadPayload[key] === "string") {
            configLabelKey = payloadPayload[key];
        }
        return configLabelKey in config
            ? config[configLabelKey]
            : config[key];
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2hhcnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcG9uZW50cy91aS9jaGFydC50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtJQUFBLFlBQVksQ0FBQzs7OztJQU9iLHVDQUF1QztJQUN2QyxNQUFNLE1BQU0sR0FBRyxFQUFFLEtBQUssRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBVyxDQUFDO0lBZ0JyRCxNQUFNLFlBQVksR0FBRyxLQUFLLENBQUMsYUFBYSxDQUEyQixJQUFJLENBQUMsQ0FBQztJQUV6RSxTQUFTLFFBQVE7UUFDZixNQUFNLE9BQU8sR0FBRyxLQUFLLENBQUMsVUFBVSxDQUFDLFlBQVksQ0FBQyxDQUFDO1FBRS9DLElBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQztZQUNiLE1BQU0sSUFBSSxLQUFLLENBQUMsbURBQW1ELENBQUMsQ0FBQztRQUN2RSxDQUFDO1FBRUQsT0FBTyxPQUFPLENBQUM7SUFDakIsQ0FBQztJQUVELE1BQU0sY0FBYyxHQUFHLEtBQUssQ0FBQyxVQUFVLENBUXJDLENBQUMsRUFBRSxFQUFFLEVBQUUsU0FBUyxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsR0FBRyxLQUFLLEVBQUUsRUFBRSxHQUFHLEVBQUUsRUFBRTtRQUN2RCxNQUFNLFFBQVEsR0FBRyxLQUFLLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDL0IsTUFBTSxPQUFPLEdBQUcsU0FBUyxFQUFFLElBQUksUUFBUSxDQUFDLE9BQU8sQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLEVBQUUsQ0FBQztRQUU1RCxPQUFPLENBQ0wsdUJBQUMsWUFBWSxDQUFDLFFBQVEsSUFBQyxLQUFLLEVBQUUsRUFBRSxNQUFNLEVBQUUsWUFDdEMsK0NBQ2MsT0FBTyxFQUNuQixHQUFHLEVBQUUsR0FBRyxFQUNSLFNBQVMsRUFBRSxJQUFBLFVBQUUsRUFDWCx1cEJBQXVwQixFQUN2cEIsU0FBUyxDQUNWLEtBQ0csS0FBSyxh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QTlDcEIsa0JBQWtCLENBQUMsV0FBVyxHQUFHLGFBQWEsQ0FBQztJQUUvQyxnREFBZ0Q7SUFDaEQsU0FBUywyQkFBMkIsQ0FDbEMsTUFBbUIsRUFDbkIsT0FBZ0IsRUFDaEIsR0FBVztRQUVYLElBQUksT0FBTyxPQUFPLEtBQUssUUFBUSxJQUFJLE9BQU8sS0FBSyxJQUFJLEVBQUUsQ0FBQztZQUNwRCxPQUFPLFNBQVMsQ0FBQztRQUNuQixDQUFDO1FBRUQsTUFBTSxjQUFjLEdBQ2xCLFNBQVMsSUFBSSxPQUFPO1lBQ3BCLE9BQU8sT0FBTyxDQUFDLE9BQU8sS0FBSyxRQUFRO1lBQ25DLE9BQU8sQ0FBQyxPQUFPLEtBQUssSUFBSTtZQUN0QixDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU87WUFDakIsQ0FBQyxDQUFDLFNBQVMsQ0FBQztRQUVoQixJQUFJLGNBQWMsR0FBVyxHQUFHLENBQUM7UUFFakMsSUFDRSxHQUFHLElBQUksT0FBTztZQUNkLE9BQU8sT0FBTyxDQUFDLEdBQTJCLENBQUMsS0FBSyxRQUFRLEVBQ3hELENBQUM7WUFDRCxjQUFjLEdBQUcsT0FBTyxDQUFDLEdBQTJCLENBQVcsQ0FBQztRQUNsRSxDQUFDO2FBQU0sSUFDTCxjQUFjO1lBQ2QsR0FBRyxJQUFJLGNBQWM7WUFDckIsT0FBTyxjQUFjLENBQUMsR0FBa0MsQ0FBQyxLQUFLLFFBQVEsRUFDdEUsQ0FBQztZQUNELGNBQWMsR0FBRyxjQUFjLENBQzdCLEdBQWtDLENBQ3pCLENBQUM7UUFDZCxDQUFDO1FBRUQsT0FBTyxjQUFjLElBQUksTUFBTTtZQUM3QixDQUFDLENBQUMsTUFBTSxDQUFDLGNBQWMsQ0FBQztZQUN4QixDQUFDLENBQUMsTUFBTSxDQUFDLEdBQTBCLENBQUMsQ0FBQztJQUN6QyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2UgY2xpZW50XCI7XG5cbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0ICogYXMgUmVjaGFydHNQcmltaXRpdmUgZnJvbSBcInJlY2hhcnRzXCI7XG5cbmltcG9ydCB7IGNuIH0gZnJvbSBcIkAvbGliL3V0aWxzXCI7XG5cbi8vIEZvcm1hdDogeyBUSEVNRV9OQU1FOiBDU1NfU0VMRUNUT1IgfVxuY29uc3QgVEhFTUVTID0geyBsaWdodDogXCJcIiwgZGFyazogXCIuZGFya1wiIH0gYXMgY29uc3Q7XG5cbmV4cG9ydCB0eXBlIENoYXJ0Q29uZmlnID0ge1xuICBbayBpbiBzdHJpbmddOiB7XG4gICAgbGFiZWw/OiBSZWFjdC5SZWFjdE5vZGU7XG4gICAgaWNvbj86IFJlYWN0LkNvbXBvbmVudFR5cGU7XG4gIH0gJiAoXG4gICAgfCB7IGNvbG9yPzogc3RyaW5nOyB0aGVtZT86IG5ldmVyIH1cbiAgICB8IHsgY29sb3I/OiBuZXZlcjsgdGhlbWU6IFJlY29yZDxrZXlvZiB0eXBlb2YgVEhFTUVTLCBzdHJpbmc+IH1cbiAgKTtcbn07XG5cbnR5cGUgQ2hhcnRDb250ZXh0UHJvcHMgPSB7XG4gIGNvbmZpZzogQ2hhcnRDb25maWc7XG59O1xuXG5jb25zdCBDaGFydENvbnRleHQgPSBSZWFjdC5jcmVhdGVDb250ZXh0PENoYXJ0Q29udGV4dFByb3BzIHwgbnVsbD4obnVsbCk7XG5cbmZ1bmN0aW9uIHVzZUNoYXJ0KCkge1xuICBjb25zdCBjb250ZXh0ID0gUmVhY3QudXNlQ29udGV4dChDaGFydENvbnRleHQpO1xuXG4gIGlmICghY29udGV4dCkge1xuICAgIHRocm93IG5ldyBFcnJvcihcInVzZUNoYXJ0IG11c3QgYmUgdXNlZCB3aXRoaW4gYSA8Q2hhcnRDb250YWluZXIgLz5cIik7XG4gIH1cblxuICByZXR1cm4gY29udGV4dDtcbn1cblxuY29uc3QgQ2hhcnRDb250YWluZXIgPSBSZWFjdC5mb3J3YXJkUmVmPFxuICBIVE1MRGl2RWxlbWVudCxcbiAgUmVhY3QuQ29tcG9uZW50UHJvcHM8XCJkaXZcIj4gJiB7XG4gICAgY29uZmlnOiBDaGFydENvbmZpZztcbiAgICBjaGlsZHJlbjogUmVhY3QuQ29tcG9uZW50UHJvcHM8XG4gICAgICB0eXBlb2YgUmVjaGFydHNQcmltaXRpdmUuUmVzcG9uc2l2ZUNvbnRhaW5lclxuICAgID5bXCJjaGlsZHJlblwiXTtcbiAgfVxuPigoeyBpZCwgY2xhc3NOYW1lLCBjaGlsZHJlbiwgY29uZmlnLCAuLi5wcm9wcyB9LCByZWYpID0+IHtcbiAgY29uc3QgdW5pcXVlSWQgPSBSZWFjdC51c2VJZCgpO1xuICBjb25zdCBjaGFydElkID0gYGNoYXJ0LSR7aWQgfHwgdW5pcXVlSWQucmVwbGFjZSgvOi9nLCBcIlwiKX1gO1xuXG4gIHJldHVybiAoXG4gICAgPENoYXJ0Q29udGV4dC5Qcm92aWRlciB2YWx1ZT17eyBjb25maWcgfX0+XG4gICAgICA8ZGl2XG4gICAgICAgIGRhdGEtY2hhcnQ9e2NoYXJ0SWR9XG4gICAgICAgIHJlZj17cmVmfVxuICAgICAgICBjbGFzc05hbWU9e2NuKFxuICAgICAgICAgIFwiZmxleCBhc3BlY3QtdmlkZW8ganVzdGlmeS1jZW50ZXIgdGV4dC14cyBbJl8ucmVjaGFydHMtY2FydGVzaWFuLWF4aXMtdGlja190ZXh0XTpmaWxsLW11dGVkLWZvcmVncm91bmQgWyZfLnJlY2hhcnRzLWNhcnRlc2lhbi1ncmlkX2xpbmVbc3Ryb2tlPScjY2NjJ11dOnN0cm9rZS1ib3JkZXIvNTAgWyZfLnJlY2hhcnRzLWN1cnZlLnJlY2hhcnRzLXRvb2x0aXAtY3Vyc29yXTpzdHJva2UtYm9yZGVyIFsmXy5yZWNoYXJ0cy1kb3Rbc3Ryb2tlPScjZmZmJ11dOnN0cm9rZS10cmFuc3BhcmVudCBbJl8ucmVjaGFydHMtbGF5ZXJdOm91dGxpbmUtbm9uZSBbJl8ucmVjaGFydHMtcG9sYXItZ3JpZF9bc3Ryb2tlPScjY2NjJ11dOnN0cm9rZS1ib3JkZXIgWyZfLnJlY2hhcnRzLXJhZGlhbC1iYXItYmFja2dyb3VuZC1zZWN0b3JdOmZpbGwtbXV0ZWQgWyZfLnJlY2hhcnRzLXJlY3RhbmdsZS5yZWNoYXJ0cy10b29sdGlwLWN1cnNvcl06ZmlsbC1tdXRlZCBbJl8ucmVjaGFydHMtcmVmZXJlbmNlLWxpbmVfW3N0cm9rZT0nI2NjYyddXTpzdHJva2UtYm9yZGVyIFsmXy5yZWNoYXJ0cy1zZWN0b3Jbc3Ryb2tlPScjZmZmJ11dOnN0cm9rZS10cmFuc3BhcmVudCBbJl8ucmVjaGFydHMtc2VjdG9yXTpvdXRsaW5lLW5vbmUgWyZfLnJlY2hhcnRzLXN1cmZhY2VdOm91dGxpbmUtbm9uZVwiLFxuICAgICAgICAgIGNsYXNzTmFtZSxcbiAgICAgICAgKX1cbiAgICAgICAgey4uLnByb3BzfVxuICAgICAgPlxuICAgICAgICA8Q2hhcnRTdHlsZSBpZD17Y2hhcnRJZH0gY29uZmlnPXtjb25maWd9IC8+XG4gICAgICAgIDxSZWNoYXJ0c1ByaW1pdGl2ZS5SZXNwb25zaXZlQ29udGFpbmVyPlxuICAgICAgICAgIHtjaGlsZHJlbn1cbiAgICAgICAgPC9SZWNoYXJ0c1ByaW1pdGl2ZS5SZXNwb25zaXZlQ29udGFpbmVyPlxuICAgICAgPC9kaXY+XG4gICAgPC9DaGFydENvbnRleHQuUHJvdmlkZXI+XG4gICk7XG59KTtcbkNoYXJ0Q29udGFpbmVyLmRpc3BsYXlOYW1lID0gXCJDaGFydFwiO1xuXG5jb25zdCBDaGFydFN0eWxlID0gKHsgaWQsIGNvbmZpZyB9OiB7IGlkOiBzdHJpbmc7IGNvbmZpZzogQ2hhcnRDb25maWcgfSkgPT4ge1xuICBjb25zdCBjb2xvckNvbmZpZyA9IE9iamVjdC5lbnRyaWVzKGNvbmZpZykuZmlsdGVyKFxuICAgIChbLCBjb25maWddKSA9PiBjb25maWcudGhlbWUgfHwgY29uZmlnLmNvbG9yLFxuICApO1xuXG4gIGlmICghY29sb3JDb25maWcubGVuZ3RoKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICByZXR1cm4gKFxuICAgIDxzdHlsZVxuICAgICAgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw9e3tcbiAgICAgICAgX19odG1sOiBPYmplY3QuZW50cmllcyhUSEVNRVMpXG4gICAgICAgICAgLm1hcChcbiAgICAgICAgICAgIChbdGhlbWUsIHByZWZpeF0pID0+IGBcbiR7cHJlZml4fSBbZGF0YS1jaGFydD0ke2lkfV0ge1xuJHtjb2xvckNvbmZpZ1xuICAubWFwKChba2V5LCBpdGVtQ29uZmlnXSkgPT4ge1xuICAgIGNvbnN0IGNvbG9yID1cbiAgICAgIGl0ZW1Db25maWcudGhlbWU/Llt0aGVtZSBhcyBrZXlvZiB0eXBlb2YgaXRlbUNvbmZpZy50aGVtZV0gfHxcbiAgICAgIGl0ZW1Db25maWcuY29sb3I7XG4gICAgcmV0dXJuIGNvbG9yID8gYCAgLS1jb2xvci0ke2tleX06ICR7Y29sb3J9O2AgOiBudWxsO1xuICB9KVxuICAuam9pbihcIlxcblwiKX1cbn1cbmAsXG4gICAgICAgICAgKVxuICAgICAgICAgIC5qb2luKFwiXFxuXCIpLFxuICAgICAgfX1cbiAgICAvPlxuICApO1xufTtcblxuY29uc3QgQ2hhcnRUb29sdGlwID0gUmVjaGFydHNQcmltaXRpdmUuVG9vbHRpcDtcblxuY29uc3QgQ2hhcnRUb29sdGlwQ29udGVudCA9IFJlYWN0LmZvcndhcmRSZWY8XG4gIEhUTUxEaXZFbGVtZW50LFxuICBSZWFjdC5Db21wb25lbnRQcm9wczx0eXBlb2YgUmVjaGFydHNQcmltaXRpdmUuVG9vbHRpcD4gJlxuICAgIFJlYWN0LkNvbXBvbmVudFByb3BzPFwiZGl2XCI+ICYge1xuICAgICAgaGlkZUxhYmVsPzogYm9vbGVhbjtcbiAgICAgIGhpZGVJbmRpY2F0b3I/OiBib29sZWFuO1xuICAgICAgaW5kaWNhdG9yPzogXCJsaW5lXCIgfCBcImRvdFwiIHwgXCJkYXNoZWRcIjtcbiAgICAgIG5hbWVLZXk/OiBzdHJpbmc7XG4gICAgICBsYWJlbEtleT86IHN0cmluZztcbiAgICB9XG4+KFxuICAoXG4gICAge1xuICAgICAgYWN0aXZlLFxuICAgICAgcGF5bG9hZCxcbiAgICAgIGNsYXNzTmFtZSxcbiAgICAgIGluZGljYXRvciA9IFwiZG90XCIsXG4gICAgICBoaWRlTGFiZWwgPSBmYWxzZSxcbiAgICAgIGhpZGVJbmRpY2F0b3IgPSBmYWxzZSxcbiAgICAgIGxhYmVsLFxuICAgICAgbGFiZWxGb3JtYXR0ZXIsXG4gICAgICBsYWJlbENsYXNzTmFtZSxcbiAgICAgIGZvcm1hdHRlcixcbiAgICAgIGNvbG9yLFxuICAgICAgbmFtZUtleSxcbiAgICAgIGxhYmVsS2V5LFxuICAgIH0sXG4gICAgcmVmLFxuICApID0+IHtcbiAgICBjb25zdCB7IGNvbmZpZyB9ID0gdXNlQ2hhcnQoKTtcblxuICAgIGNvbnN0IHRvb2x0aXBMYWJlbCA9IFJlYWN0LnVzZU1lbW8oKCkgPT4ge1xuICAgICAgaWYgKGhpZGVMYWJlbCB8fCAhcGF5bG9hZD8ubGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBbaXRlbV0gPSBwYXlsb2FkO1xuICAgICAgY29uc3Qga2V5ID0gYCR7bGFiZWxLZXkgfHwgaXRlbT8uZGF0YUtleSB8fCBpdGVtPy5uYW1lIHx8IFwidmFsdWVcIn1gO1xuICAgICAgY29uc3QgaXRlbUNvbmZpZyA9IGdldFBheWxvYWRDb25maWdGcm9tUGF5bG9hZChjb25maWcsIGl0ZW0sIGtleSk7XG4gICAgICBjb25zdCB2YWx1ZSA9XG4gICAgICAgICFsYWJlbEtleSAmJiB0eXBlb2YgbGFiZWwgPT09IFwic3RyaW5nXCJcbiAgICAgICAgICA/IGNvbmZpZ1tsYWJlbCBhcyBrZXlvZiB0eXBlb2YgY29uZmlnXT8ubGFiZWwgfHwgbGFiZWxcbiAgICAgICAgICA6IGl0ZW1Db25maWc/LmxhYmVsO1xuXG4gICAgICBpZiAobGFiZWxGb3JtYXR0ZXIpIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17Y24oXCJmb250LW1lZGl1bVwiLCBsYWJlbENsYXNzTmFtZSl9PlxuICAgICAgICAgICAge2xhYmVsRm9ybWF0dGVyKHZhbHVlLCBwYXlsb2FkKX1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCF2YWx1ZSkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPXtjbihcImZvbnQtbWVkaXVtXCIsIGxhYmVsQ2xhc3NOYW1lKX0+e3ZhbHVlfTwvZGl2PjtcbiAgICB9LCBbXG4gICAgICBsYWJlbCxcbiAgICAgIGxhYmVsRm9ybWF0dGVyLFxuICAgICAgcGF5bG9hZCxcbiAgICAgIGhpZGVMYWJlbCxcbiAgICAgIGxhYmVsQ2xhc3NOYW1lLFxuICAgICAgY29uZmlnLFxuICAgICAgbGFiZWxLZXksXG4gICAgXSk7XG5cbiAgICBpZiAoIWFjdGl2ZSB8fCAhcGF5bG9hZD8ubGVuZ3RoKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBjb25zdCBuZXN0TGFiZWwgPSBwYXlsb2FkLmxlbmd0aCA9PT0gMSAmJiBpbmRpY2F0b3IgIT09IFwiZG90XCI7XG5cbiAgICByZXR1cm4gKFxuICAgICAgPGRpdlxuICAgICAgICByZWY9e3JlZn1cbiAgICAgICAgY2xhc3NOYW1lPXtjbihcbiAgICAgICAgICBcImdyaWQgbWluLXctWzhyZW1dIGl0ZW1zLXN0YXJ0IGdhcC0xLjUgcm91bmRlZC1sZyBib3JkZXIgYm9yZGVyLWJvcmRlci81MCBiZy1iYWNrZ3JvdW5kIHB4LTIuNSBweS0xLjUgdGV4dC14cyBzaGFkb3cteGxcIixcbiAgICAgICAgICBjbGFzc05hbWUsXG4gICAgICAgICl9XG4gICAgICA+XG4gICAgICAgIHshbmVzdExhYmVsID8gdG9vbHRpcExhYmVsIDogbnVsbH1cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkIGdhcC0xLjVcIj5cbiAgICAgICAgICB7cGF5bG9hZC5tYXAoKGl0ZW0sIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBrZXkgPSBgJHtuYW1lS2V5IHx8IGl0ZW0ubmFtZSB8fCBpdGVtLmRhdGFLZXkgfHwgXCJ2YWx1ZVwifWA7XG4gICAgICAgICAgICBjb25zdCBpdGVtQ29uZmlnID0gZ2V0UGF5bG9hZENvbmZpZ0Zyb21QYXlsb2FkKGNvbmZpZywgaXRlbSwga2V5KTtcbiAgICAgICAgICAgIGNvbnN0IGluZGljYXRvckNvbG9yID0gY29sb3IgfHwgaXRlbS5wYXlsb2FkLmZpbGwgfHwgaXRlbS5jb2xvcjtcblxuICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgIGtleT17aXRlbS5kYXRhS2V5fVxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17Y24oXG4gICAgICAgICAgICAgICAgICBcImZsZXggdy1mdWxsIGZsZXgtd3JhcCBpdGVtcy1zdHJldGNoIGdhcC0yIFsmPnN2Z106aC0yLjUgWyY+c3ZnXTp3LTIuNSBbJj5zdmddOnRleHQtbXV0ZWQtZm9yZWdyb3VuZFwiLFxuICAgICAgICAgICAgICAgICAgaW5kaWNhdG9yID09PSBcImRvdFwiICYmIFwiaXRlbXMtY2VudGVyXCIsXG4gICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIHtmb3JtYXR0ZXIgJiYgaXRlbT8udmFsdWUgIT09IHVuZGVmaW5lZCAmJiBpdGVtLm5hbWUgPyAoXG4gICAgICAgICAgICAgICAgICBmb3JtYXR0ZXIoaXRlbS52YWx1ZSwgaXRlbS5uYW1lLCBpdGVtLCBpbmRleCwgaXRlbS5wYXlsb2FkKVxuICAgICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgICA8PlxuICAgICAgICAgICAgICAgICAgICB7aXRlbUNvbmZpZz8uaWNvbiA/IChcbiAgICAgICAgICAgICAgICAgICAgICA8aXRlbUNvbmZpZy5pY29uIC8+XG4gICAgICAgICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgICAgICAgIWhpZGVJbmRpY2F0b3IgJiYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2NuKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2hyaW5rLTAgcm91bmRlZC1bMnB4XSBib3JkZXItWy0tY29sb3ItYm9yZGVyXSBiZy1bLS1jb2xvci1iZ11cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImgtMi41IHctMi41XCI6IGluZGljYXRvciA9PT0gXCJkb3RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidy0xXCI6IGluZGljYXRvciA9PT0gXCJsaW5lXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInctMCBib3JkZXItWzEuNXB4XSBib3JkZXItZGFzaGVkIGJnLXRyYW5zcGFyZW50XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGljYXRvciA9PT0gXCJkYXNoZWRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibXktMC41XCI6IG5lc3RMYWJlbCAmJiBpbmRpY2F0b3IgPT09IFwiZGFzaGVkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiLS1jb2xvci1iZ1wiOiBpbmRpY2F0b3JDb2xvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiLS1jb2xvci1ib3JkZXJcIjogaW5kaWNhdG9yQ29sb3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBhcyBSZWFjdC5DU1NQcm9wZXJ0aWVzXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtjbihcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZmxleCBmbGV4LTEganVzdGlmeS1iZXR3ZWVuIGxlYWRpbmctbm9uZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgbmVzdExhYmVsID8gXCJpdGVtcy1lbmRcIiA6IFwiaXRlbXMtY2VudGVyXCIsXG4gICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZCBnYXAtMS41XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICB7bmVzdExhYmVsID8gdG9vbHRpcExhYmVsIDogbnVsbH1cbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInRleHQtbXV0ZWQtZm9yZWdyb3VuZFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICB7aXRlbUNvbmZpZz8ubGFiZWwgfHwgaXRlbS5uYW1lfVxuICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgIHtpdGVtLnZhbHVlICYmIChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cImZvbnQtbW9ubyBmb250LW1lZGl1bSB0YWJ1bGFyLW51bXMgdGV4dC1mb3JlZ3JvdW5kXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHtpdGVtLnZhbHVlLnRvTG9jYWxlU3RyaW5nKCl9XG4gICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICA8Lz5cbiAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfSl9XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgKTtcbiAgfSxcbik7XG5DaGFydFRvb2x0aXBDb250ZW50LmRpc3BsYXlOYW1lID0gXCJDaGFydFRvb2x0aXBcIjtcblxuY29uc3QgQ2hhcnRMZWdlbmQgPSBSZWNoYXJ0c1ByaW1pdGl2ZS5MZWdlbmQ7XG5cbmNvbnN0IENoYXJ0TGVnZW5kQ29udGVudCA9IFJlYWN0LmZvcndhcmRSZWY8XG4gIEhUTUxEaXZFbGVtZW50LFxuICBSZWFjdC5Db21wb25lbnRQcm9wczxcImRpdlwiPiAmXG4gICAgUGljazxSZWNoYXJ0c1ByaW1pdGl2ZS5MZWdlbmRQcm9wcywgXCJwYXlsb2FkXCIgfCBcInZlcnRpY2FsQWxpZ25cIj4gJiB7XG4gICAgICBoaWRlSWNvbj86IGJvb2xlYW47XG4gICAgICBuYW1lS2V5Pzogc3RyaW5nO1xuICAgIH1cbj4oXG4gIChcbiAgICB7IGNsYXNzTmFtZSwgaGlkZUljb24gPSBmYWxzZSwgcGF5bG9hZCwgdmVydGljYWxBbGlnbiA9IFwiYm90dG9tXCIsIG5hbWVLZXkgfSxcbiAgICByZWYsXG4gICkgPT4ge1xuICAgIGNvbnN0IHsgY29uZmlnIH0gPSB1c2VDaGFydCgpO1xuXG4gICAgaWYgKCFwYXlsb2FkPy5sZW5ndGgpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHJldHVybiAoXG4gICAgICA8ZGl2XG4gICAgICAgIHJlZj17cmVmfVxuICAgICAgICBjbGFzc05hbWU9e2NuKFxuICAgICAgICAgIFwiZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgZ2FwLTRcIixcbiAgICAgICAgICB2ZXJ0aWNhbEFsaWduID09PSBcInRvcFwiID8gXCJwYi0zXCIgOiBcInB0LTNcIixcbiAgICAgICAgICBjbGFzc05hbWUsXG4gICAgICAgICl9XG4gICAgICA+XG4gICAgICAgIHtwYXlsb2FkLm1hcCgoaXRlbSkgPT4ge1xuICAgICAgICAgIGNvbnN0IGtleSA9IGAke25hbWVLZXkgfHwgaXRlbS5kYXRhS2V5IHx8IFwidmFsdWVcIn1gO1xuICAgICAgICAgIGNvbnN0IGl0ZW1Db25maWcgPSBnZXRQYXlsb2FkQ29uZmlnRnJvbVBheWxvYWQoY29uZmlnLCBpdGVtLCBrZXkpO1xuXG4gICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAga2V5PXtpdGVtLnZhbHVlfVxuICAgICAgICAgICAgICBjbGFzc05hbWU9e2NuKFxuICAgICAgICAgICAgICAgIFwiZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTEuNSBbJj5zdmddOmgtMyBbJj5zdmddOnctMyBbJj5zdmddOnRleHQtbXV0ZWQtZm9yZWdyb3VuZFwiLFxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICB7aXRlbUNvbmZpZz8uaWNvbiAmJiAhaGlkZUljb24gPyAoXG4gICAgICAgICAgICAgICAgPGl0ZW1Db25maWcuaWNvbiAvPlxuICAgICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImgtMiB3LTIgc2hyaW5rLTAgcm91bmRlZC1bMnB4XVwiXG4gICAgICAgICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IGl0ZW0uY29sb3IsXG4gICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgIHtpdGVtQ29uZmlnPy5sYWJlbH1cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICk7XG4gICAgICAgIH0pfVxuICAgICAgPC9kaXY+XG4gICAgKTtcbiAgfSxcbik7XG5DaGFydExlZ2VuZENvbnRlbnQuZGlzcGxheU5hbWUgPSBcIkNoYXJ0TGVnZW5kXCI7XG5cbi8vIEhlbHBlciB0byBleHRyYWN0IGl0ZW0gY29uZmlnIGZyb20gYSBwYXlsb2FkLlxuZnVuY3Rpb24gZ2V0UGF5bG9hZENvbmZpZ0Zyb21QYXlsb2FkKFxuICBjb25maWc6IENoYXJ0Q29uZmlnLFxuICBwYXlsb2FkOiB1bmtub3duLFxuICBrZXk6IHN0cmluZyxcbikge1xuICBpZiAodHlwZW9mIHBheWxvYWQgIT09IFwib2JqZWN0XCIgfHwgcGF5bG9hZCA9PT0gbnVsbCkge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cblxuICBjb25zdCBwYXlsb2FkUGF5bG9hZCA9XG4gICAgXCJwYXlsb2FkXCIgaW4gcGF5bG9hZCAmJlxuICAgIHR5cGVvZiBwYXlsb2FkLnBheWxvYWQgPT09IFwib2JqZWN0XCIgJiZcbiAgICBwYXlsb2FkLnBheWxvYWQgIT09IG51bGxcbiAgICAgID8gcGF5bG9hZC5wYXlsb2FkXG4gICAgICA6IHVuZGVmaW5lZDtcblxuICBsZXQgY29uZmlnTGFiZWxLZXk6IHN0cmluZyA9IGtleTtcblxuICBpZiAoXG4gICAga2V5IGluIHBheWxvYWQgJiZcbiAgICB0eXBlb2YgcGF5bG9hZFtrZXkgYXMga2V5b2YgdHlwZW9mIHBheWxvYWRdID09PSBcInN0cmluZ1wiXG4gICkge1xuICAgIGNvbmZpZ0xhYmVsS2V5ID0gcGF5bG9hZFtrZXkgYXMga2V5b2YgdHlwZW9mIHBheWxvYWRdIGFzIHN0cmluZztcbiAgfSBlbHNlIGlmIChcbiAgICBwYXlsb2FkUGF5bG9hZCAmJlxuICAgIGtleSBpbiBwYXlsb2FkUGF5bG9hZCAmJlxuICAgIHR5cGVvZiBwYXlsb2FkUGF5bG9hZFtrZXkgYXMga2V5b2YgdHlwZW9mIHBheWxvYWRQYXlsb2FkXSA9PT0gXCJzdHJpbmdcIlxuICApIHtcbiAgICBjb25maWdMYWJlbEtleSA9IHBheWxvYWRQYXlsb2FkW1xuICAgICAga2V5IGFzIGtleW9mIHR5cGVvZiBwYXlsb2FkUGF5bG9hZFxuICAgIF0gYXMgc3RyaW5nO1xuICB9XG5cbiAgcmV0dXJuIGNvbmZpZ0xhYmVsS2V5IGluIGNvbmZpZ1xuICAgID8gY29uZmlnW2NvbmZpZ0xhYmVsS2V5XVxuICAgIDogY29uZmlnW2tleSBhcyBrZXlvZiB0eXBlb2YgY29uZmlnXTtcbn1cblxuZXhwb3J0IHtcbiAgQ2hhcnRDb250YWluZXIsXG4gIENoYXJ0VG9vbHRpcCxcbiAgQ2hhcnRUb29sdGlwQ29udGVudCxcbiAgQ2hhcnRMZWdlbmQsXG4gIENoYXJ0TGVnZW5kQ29udGVudCxcbiAgQ2hhcnRTdHlsZSxcbn07XG4iXX0=