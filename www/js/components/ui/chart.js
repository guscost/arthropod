define(["require", "exports", "react/jsx-runtime", "react", "recharts", "@/lib/utils"], function (require, exports, jsx_runtime_1, React, RechartsPrimitive, utils_1) {
    "use client";
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.ChartStyle = exports.ChartLegend = exports.ChartTooltip = void 0;
    exports.ChartContainer = ChartContainer;
    exports.ChartTooltipContent = ChartTooltipContent;
    exports.ChartLegendContent = ChartLegendContent;
    // Format: { THEME_NAME: CSS_SELECTOR }
    const THEMES = { light: "", dark: ".dark" };
    const ChartContext = React.createContext(null);
    function useChart() {
        const context = React.useContext(ChartContext);
        if (!context) {
            throw new Error("useChart must be used within a <ChartContainer />");
        }
        return context;
    }
    function ChartContainer({ id, className, children, config, ...props }) {
        const uniqueId = React.useId();
        const chartId = `chart-${id || uniqueId.replace(/:/g, "")}`;
        return ((0, jsx_runtime_1.jsx)(ChartContext.Provider, { value: { config }, children: (0, jsx_runtime_1.jsxs)("div", { "data-slot": "chart", "data-chart": chartId, className: (0, utils_1.cn)("[&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border flex aspect-video justify-center text-xs [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-hidden [&_.recharts-sector]:outline-hidden [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-surface]:outline-hidden", className), ...props, children: [(0, jsx_runtime_1.jsx)(ChartStyle, { id: chartId, config: config }), (0, jsx_runtime_1.jsx)(RechartsPrimitive.ResponsiveContainer, { children: children })] }) }));
    }
    const ChartStyle = ({ id, config }) => {
        const colorConfig = Object.entries(config).filter(([, config]) => config.theme || config.color);
        if (!colorConfig.length) {
            return null;
        }
        return ((0, jsx_runtime_1.jsx)("style", { dangerouslySetInnerHTML: {
                __html: Object.entries(THEMES)
                    .map(([theme, prefix]) => `
${prefix} [data-chart=${id}] {
${colorConfig
                    .map(([key, itemConfig]) => {
                    var _a;
                    const color = ((_a = itemConfig.theme) === null || _a === void 0 ? void 0 : _a[theme]) ||
                        itemConfig.color;
                    return color ? `  --color-${key}: ${color};` : null;
                })
                    .join("\n")}
}
`)
                    .join("\n"),
            } }));
    };
    exports.ChartStyle = ChartStyle;
    const ChartTooltip = RechartsPrimitive.Tooltip;
    exports.ChartTooltip = ChartTooltip;
    function ChartTooltipContent({ active, payload, className, indicator = "dot", hideLabel = false, hideIndicator = false, label, labelFormatter, labelClassName, formatter, color, nameKey, labelKey, }) {
        const { config } = useChart();
        const tooltipLabel = React.useMemo(() => {
            var _a;
            if (hideLabel || !(payload === null || payload === void 0 ? void 0 : payload.length)) {
                return null;
            }
            const [item] = payload;
            const key = `${labelKey || (item === null || item === void 0 ? void 0 : item.dataKey) || (item === null || item === void 0 ? void 0 : item.name) || "value"}`;
            const itemConfig = getPayloadConfigFromPayload(config, item, key);
            const value = !labelKey && typeof label === "string"
                ? ((_a = config[label]) === null || _a === void 0 ? void 0 : _a.label) || label
                : itemConfig === null || itemConfig === void 0 ? void 0 : itemConfig.label;
            if (labelFormatter) {
                return ((0, jsx_runtime_1.jsx)("div", { className: (0, utils_1.cn)("font-medium", labelClassName), children: labelFormatter(value, payload) }));
            }
            if (!value) {
                return null;
            }
            return (0, jsx_runtime_1.jsx)("div", { className: (0, utils_1.cn)("font-medium", labelClassName), children: value });
        }, [
            label,
            labelFormatter,
            payload,
            hideLabel,
            labelClassName,
            config,
            labelKey,
        ]);
        if (!active || !(payload === null || payload === void 0 ? void 0 : payload.length)) {
            return null;
        }
        const nestLabel = payload.length === 1 && indicator !== "dot";
        return ((0, jsx_runtime_1.jsxs)("div", { className: (0, utils_1.cn)("border-border/50 bg-background grid min-w-[8rem] items-start gap-1.5 rounded-lg border px-2.5 py-1.5 text-xs shadow-xl", className), children: [!nestLabel ? tooltipLabel : null, (0, jsx_runtime_1.jsx)("div", { className: "grid gap-1.5", children: payload
                        .filter((item) => item.type !== "none")
                        .map((item, index) => {
                        const key = `${nameKey || item.name || item.dataKey || "value"}`;
                        const itemConfig = getPayloadConfigFromPayload(config, item, key);
                        const indicatorColor = color || item.payload.fill || item.color;
                        return ((0, jsx_runtime_1.jsx)("div", { className: (0, utils_1.cn)("[&>svg]:text-muted-foreground flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5", indicator === "dot" && "items-center"), children: formatter && (item === null || item === void 0 ? void 0 : item.value) !== undefined && item.name ? (formatter(item.value, item.name, item, index, item.payload)) : ((0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [(itemConfig === null || itemConfig === void 0 ? void 0 : itemConfig.icon) ? ((0, jsx_runtime_1.jsx)(itemConfig.icon, {})) : (!hideIndicator && ((0, jsx_runtime_1.jsx)("div", { className: (0, utils_1.cn)("shrink-0 rounded-[2px] border-(--color-border) bg-(--color-bg)", {
                                            "h-2.5 w-2.5": indicator === "dot",
                                            "w-1": indicator === "line",
                                            "w-0 border-[1.5px] border-dashed bg-transparent": indicator === "dashed",
                                            "my-0.5": nestLabel && indicator === "dashed",
                                        }), style: {
                                            "--color-bg": indicatorColor,
                                            "--color-border": indicatorColor,
                                        } }))), (0, jsx_runtime_1.jsxs)("div", { className: (0, utils_1.cn)("flex flex-1 justify-between leading-none", nestLabel ? "items-end" : "items-center"), children: [(0, jsx_runtime_1.jsxs)("div", { className: "grid gap-1.5", children: [nestLabel ? tooltipLabel : null, (0, jsx_runtime_1.jsx)("span", { className: "text-muted-foreground", children: (itemConfig === null || itemConfig === void 0 ? void 0 : itemConfig.label) || item.name })] }), item.value && ((0, jsx_runtime_1.jsx)("span", { className: "text-foreground font-mono font-medium tabular-nums", children: item.value.toLocaleString() }))] })] })) }, item.dataKey));
                    }) })] }));
    }
    const ChartLegend = RechartsPrimitive.Legend;
    exports.ChartLegend = ChartLegend;
    function ChartLegendContent({ className, hideIcon = false, payload, verticalAlign = "bottom", nameKey, }) {
        const { config } = useChart();
        if (!(payload === null || payload === void 0 ? void 0 : payload.length)) {
            return null;
        }
        return ((0, jsx_runtime_1.jsx)("div", { className: (0, utils_1.cn)("flex items-center justify-center gap-4", verticalAlign === "top" ? "pb-3" : "pt-3", className), children: payload
                .filter((item) => item.type !== "none")
                .map((item) => {
                const key = `${nameKey || item.dataKey || "value"}`;
                const itemConfig = getPayloadConfigFromPayload(config, item, key);
                return ((0, jsx_runtime_1.jsxs)("div", { className: (0, utils_1.cn)("[&>svg]:text-muted-foreground flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3"), children: [(itemConfig === null || itemConfig === void 0 ? void 0 : itemConfig.icon) && !hideIcon ? ((0, jsx_runtime_1.jsx)(itemConfig.icon, {})) : ((0, jsx_runtime_1.jsx)("div", { className: "h-2 w-2 shrink-0 rounded-[2px]", style: {
                                backgroundColor: item.color,
                            } })), itemConfig === null || itemConfig === void 0 ? void 0 : itemConfig.label] }, item.value));
            }) }));
    }
    // Helper to extract item config from a payload.
    function getPayloadConfigFromPayload(config, payload, key) {
        if (typeof payload !== "object" || payload === null) {
            return undefined;
        }
        const payloadPayload = "payload" in payload &&
            typeof payload.payload === "object" &&
            payload.payload !== null
            ? payload.payload
            : undefined;
        let configLabelKey = key;
        if (key in payload &&
            typeof payload[key] === "string") {
            configLabelKey = payload[key];
        }
        else if (payloadPayload &&
            key in payloadPayload &&
            typeof payloadPayload[key] === "string") {
            configLabelKey = payloadPayload[key];
        }
        return configLabelKey in config
            ? config[configLabelKey]
            : config[key];
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2hhcnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcG9uZW50cy91aS9jaGFydC50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtJQUFBLFlBQVksQ0FBQzs7OztJQThWWCx3Q0FBYztJQUVkLGtEQUFtQjtJQUVuQixnREFBa0I7SUEzVnBCLHVDQUF1QztJQUN2QyxNQUFNLE1BQU0sR0FBRyxFQUFFLEtBQUssRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBVyxDQUFDO0lBZ0JyRCxNQUFNLFlBQVksR0FBRyxLQUFLLENBQUMsYUFBYSxDQUEyQixJQUFJLENBQUMsQ0FBQztJQUV6RSxTQUFTLFFBQVE7UUFDZixNQUFNLE9BQU8sR0FBRyxLQUFLLENBQUMsVUFBVSxDQUFDLFlBQVksQ0FBQyxDQUFDO1FBRS9DLElBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQztZQUNiLE1BQU0sSUFBSSxLQUFLLENBQUMsbURBQW1ELENBQUMsQ0FBQztRQUN2RSxDQUFDO1FBRUQsT0FBTyxPQUFPLENBQUM7SUFDakIsQ0FBQztJQUVELFNBQVMsY0FBYyxDQUFDLEVBQ3RCLEVBQUUsRUFDRixTQUFTLEVBQ1QsUUFBUSxFQUNSLE1BQU0sRUFDTixHQUFHLEtBQUssRUFNVDtRQUNDLE1BQU0sUUFBUSxHQUFHLEtBQUssQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUMvQixNQUFNLE9BQU8sR0FBRyxTQUFTLEVBQUUsSUFBSSxRQUFRLENBQUMsT0FBTyxDQUFDLElBQUksRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDO1FBRTVELE9BQU8sQ0FDTCx1QkFBQyxZQUFZLENBQUMsUUFBUSxJQUFDLEtBQUssRUFBRSxFQUFFLE1BQU0sRUFBRSxZQUN0Qyw4Q0FDWSxPQUFPLGdCQUNMLE9BQU8sRUFDbkIsU0FBUyxFQUFFLElBQUEsVUFBRSxFQUNYLDZwQkFBNnBCLEVBQzdwQixTQUFTLENBQ1YsS0FDRyxLQUFLLGFBRVQsdUJBQUMsVUFBVSxJ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QUNuQixDQUFDO1FBRUQsTUFBTSxjQUFjLEdBQ2xCLFNBQVMsSUFBSSxPQUFPO1lBQ3BCLE9BQU8sT0FBTyxDQUFDLE9BQU8sS0FBSyxRQUFRO1lBQ25DLE9BQU8sQ0FBQyxPQUFPLEtBQUssSUFBSTtZQUN0QixDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU87WUFDakIsQ0FBQyxDQUFDLFNBQVMsQ0FBQztRQUVoQixJQUFJLGNBQWMsR0FBVyxHQUFHLENBQUM7UUFFakMsSUFDRSxHQUFHLElBQUksT0FBTztZQUNkLE9BQU8sT0FBTyxDQUFDLEdBQTJCLENBQUMsS0FBSyxRQUFRLEVBQ3hELENBQUM7WUFDRCxjQUFjLEdBQUcsT0FBTyxDQUFDLEdBQTJCLENBQVcsQ0FBQztRQUNsRSxDQUFDO2FBQU0sSUFDTCxjQUFjO1lBQ2QsR0FBRyxJQUFJLGNBQWM7WUFDckIsT0FBTyxjQUFjLENBQUMsR0FBa0MsQ0FBQyxLQUFLLFFBQVEsRUFDdEUsQ0FBQztZQUNELGNBQWMsR0FBRyxjQUFjLENBQzdCLEdBQWtDLENBQ3pCLENBQUM7UUFDZCxDQUFDO1FBRUQsT0FBTyxjQUFjLElBQUksTUFBTTtZQUM3QixDQUFDLENBQUMsTUFBTSxDQUFDLGNBQWMsQ0FBQztZQUN4QixDQUFDLENBQUMsTUFBTSxDQUFDLEdBQTBCLENBQUMsQ0FBQztJQUN6QyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2UgY2xpZW50XCI7XG5cbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0ICogYXMgUmVjaGFydHNQcmltaXRpdmUgZnJvbSBcInJlY2hhcnRzXCI7XG5cbmltcG9ydCB7IGNuIH0gZnJvbSBcIkAvbGliL3V0aWxzXCI7XG5cbi8vIEZvcm1hdDogeyBUSEVNRV9OQU1FOiBDU1NfU0VMRUNUT1IgfVxuY29uc3QgVEhFTUVTID0geyBsaWdodDogXCJcIiwgZGFyazogXCIuZGFya1wiIH0gYXMgY29uc3Q7XG5cbmV4cG9ydCB0eXBlIENoYXJ0Q29uZmlnID0ge1xuICBbayBpbiBzdHJpbmddOiB7XG4gICAgbGFiZWw/OiBSZWFjdC5SZWFjdE5vZGU7XG4gICAgaWNvbj86IFJlYWN0LkNvbXBvbmVudFR5cGU7XG4gIH0gJiAoXG4gICAgfCB7IGNvbG9yPzogc3RyaW5nOyB0aGVtZT86IG5ldmVyIH1cbiAgICB8IHsgY29sb3I/OiBuZXZlcjsgdGhlbWU6IFJlY29yZDxrZXlvZiB0eXBlb2YgVEhFTUVTLCBzdHJpbmc+IH1cbiAgKTtcbn07XG5cbnR5cGUgQ2hhcnRDb250ZXh0UHJvcHMgPSB7XG4gIGNvbmZpZzogQ2hhcnRDb25maWc7XG59O1xuXG5jb25zdCBDaGFydENvbnRleHQgPSBSZWFjdC5jcmVhdGVDb250ZXh0PENoYXJ0Q29udGV4dFByb3BzIHwgbnVsbD4obnVsbCk7XG5cbmZ1bmN0aW9uIHVzZUNoYXJ0KCkge1xuICBjb25zdCBjb250ZXh0ID0gUmVhY3QudXNlQ29udGV4dChDaGFydENvbnRleHQpO1xuXG4gIGlmICghY29udGV4dCkge1xuICAgIHRocm93IG5ldyBFcnJvcihcInVzZUNoYXJ0IG11c3QgYmUgdXNlZCB3aXRoaW4gYSA8Q2hhcnRDb250YWluZXIgLz5cIik7XG4gIH1cblxuICByZXR1cm4gY29udGV4dDtcbn1cblxuZnVuY3Rpb24gQ2hhcnRDb250YWluZXIoe1xuICBpZCxcbiAgY2xhc3NOYW1lLFxuICBjaGlsZHJlbixcbiAgY29uZmlnLFxuICAuLi5wcm9wc1xufTogUmVhY3QuQ29tcG9uZW50UHJvcHM8XCJkaXZcIj4gJiB7XG4gIGNvbmZpZzogQ2hhcnRDb25maWc7XG4gIGNoaWxkcmVuOiBSZWFjdC5Db21wb25lbnRQcm9wczxcbiAgICB0eXBlb2YgUmVjaGFydHNQcmltaXRpdmUuUmVzcG9uc2l2ZUNvbnRhaW5lclxuICA+W1wiY2hpbGRyZW5cIl07XG59KSB7XG4gIGNvbnN0IHVuaXF1ZUlkID0gUmVhY3QudXNlSWQoKTtcbiAgY29uc3QgY2hhcnRJZCA9IGBjaGFydC0ke2lkIHx8IHVuaXF1ZUlkLnJlcGxhY2UoLzovZywgXCJcIil9YDtcblxuICByZXR1cm4gKFxuICAgIDxDaGFydENvbnRleHQuUHJvdmlkZXIgdmFsdWU9e3sgY29uZmlnIH19PlxuICAgICAgPGRpdlxuICAgICAgICBkYXRhLXNsb3Q9XCJjaGFydFwiXG4gICAgICAgIGRhdGEtY2hhcnQ9e2NoYXJ0SWR9XG4gICAgICAgIGNsYXNzTmFtZT17Y24oXG4gICAgICAgICAgXCJbJl8ucmVjaGFydHMtY2FydGVzaWFuLWF4aXMtdGlja190ZXh0XTpmaWxsLW11dGVkLWZvcmVncm91bmQgWyZfLnJlY2hhcnRzLWNhcnRlc2lhbi1ncmlkX2xpbmVbc3Ryb2tlPScjY2NjJ11dOnN0cm9rZS1ib3JkZXIvNTAgWyZfLnJlY2hhcnRzLWN1cnZlLnJlY2hhcnRzLXRvb2x0aXAtY3Vyc29yXTpzdHJva2UtYm9yZGVyIFsmXy5yZWNoYXJ0cy1wb2xhci1ncmlkX1tzdHJva2U9JyNjY2MnXV06c3Ryb2tlLWJvcmRlciBbJl8ucmVjaGFydHMtcmFkaWFsLWJhci1iYWNrZ3JvdW5kLXNlY3Rvcl06ZmlsbC1tdXRlZCBbJl8ucmVjaGFydHMtcmVjdGFuZ2xlLnJlY2hhcnRzLXRvb2x0aXAtY3Vyc29yXTpmaWxsLW11dGVkIFsmXy5yZWNoYXJ0cy1yZWZlcmVuY2UtbGluZV9bc3Ryb2tlPScjY2NjJ11dOnN0cm9rZS1ib3JkZXIgZmxleCBhc3BlY3QtdmlkZW8ganVzdGlmeS1jZW50ZXIgdGV4dC14cyBbJl8ucmVjaGFydHMtZG90W3N0cm9rZT0nI2ZmZiddXTpzdHJva2UtdHJhbnNwYXJlbnQgWyZfLnJlY2hhcnRzLWxheWVyXTpvdXRsaW5lLWhpZGRlbiBbJl8ucmVjaGFydHMtc2VjdG9yXTpvdXRsaW5lLWhpZGRlbiBbJl8ucmVjaGFydHMtc2VjdG9yW3N0cm9rZT0nI2ZmZiddXTpzdHJva2UtdHJhbnNwYXJlbnQgWyZfLnJlY2hhcnRzLXN1cmZhY2VdOm91dGxpbmUtaGlkZGVuXCIsXG4gICAgICAgICAgY2xhc3NOYW1lLFxuICAgICAgICApfVxuICAgICAgICB7Li4ucHJvcHN9XG4gICAgICA+XG4gICAgICAgIDxDaGFydFN0eWxlIGlkPXtjaGFydElkfSBjb25maWc9e2NvbmZpZ30gLz5cbiAgICAgICAgPFJlY2hhcnRzUHJpbWl0aXZlLlJlc3BvbnNpdmVDb250YWluZXI+XG4gICAgICAgICAge2NoaWxkcmVufVxuICAgICAgICA8L1JlY2hhcnRzUHJpbWl0aXZlLlJlc3BvbnNpdmVDb250YWluZXI+XG4gICAgICA8L2Rpdj5cbiAgICA8L0NoYXJ0Q29udGV4dC5Qcm92aWRlcj5cbiAgKTtcbn1cblxuY29uc3QgQ2hhcnRTdHlsZSA9ICh7IGlkLCBjb25maWcgfTogeyBpZDogc3RyaW5nOyBjb25maWc6IENoYXJ0Q29uZmlnIH0pID0+IHtcbiAgY29uc3QgY29sb3JDb25maWcgPSBPYmplY3QuZW50cmllcyhjb25maWcpLmZpbHRlcihcbiAgICAoWywgY29uZmlnXSkgPT4gY29uZmlnLnRoZW1lIHx8IGNvbmZpZy5jb2xvcixcbiAgKTtcblxuICBpZiAoIWNvbG9yQ29uZmlnLmxlbmd0aCkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgcmV0dXJuIChcbiAgICA8c3R5bGVcbiAgICAgIGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MPXt7XG4gICAgICAgIF9faHRtbDogT2JqZWN0LmVudHJpZXMoVEhFTUVTKVxuICAgICAgICAgIC5tYXAoXG4gICAgICAgICAgICAoW3RoZW1lLCBwcmVmaXhdKSA9PiBgXG4ke3ByZWZpeH0gW2RhdGEtY2hhcnQ9JHtpZH1dIHtcbiR7Y29sb3JDb25maWdcbiAgLm1hcCgoW2tleSwgaXRlbUNvbmZpZ10pID0+IHtcbiAgICBjb25zdCBjb2xvciA9XG4gICAgICBpdGVtQ29uZmlnLnRoZW1lPy5bdGhlbWUgYXMga2V5b2YgdHlwZW9mIGl0ZW1Db25maWcudGhlbWVdIHx8XG4gICAgICBpdGVtQ29uZmlnLmNvbG9yO1xuICAgIHJldHVybiBjb2xvciA/IGAgIC0tY29sb3ItJHtrZXl9OiAke2NvbG9yfTtgIDogbnVsbDtcbiAgfSlcbiAgLmpvaW4oXCJcXG5cIil9XG59XG5gLFxuICAgICAgICAgIClcbiAgICAgICAgICAuam9pbihcIlxcblwiKSxcbiAgICAgIH19XG4gICAgLz5cbiAgKTtcbn07XG5cbmNvbnN0IENoYXJ0VG9vbHRpcCA9IFJlY2hhcnRzUHJpbWl0aXZlLlRvb2x0aXA7XG5cbmZ1bmN0aW9uIENoYXJ0VG9vbHRpcENvbnRlbnQoe1xuICBhY3RpdmUsXG4gIHBheWxvYWQsXG4gIGNsYXNzTmFtZSxcbiAgaW5kaWNhdG9yID0gXCJkb3RcIixcbiAgaGlkZUxhYmVsID0gZmFsc2UsXG4gIGhpZGVJbmRpY2F0b3IgPSBmYWxzZSxcbiAgbGFiZWwsXG4gIGxhYmVsRm9ybWF0dGVyLFxuICBsYWJlbENsYXNzTmFtZSxcbiAgZm9ybWF0dGVyLFxuICBjb2xvcixcbiAgbmFtZUtleSxcbiAgbGFiZWxLZXksXG59OiBSZWFjdC5Db21wb25lbnRQcm9wczx0eXBlb2YgUmVjaGFydHNQcmltaXRpdmUuVG9vbHRpcD4gJlxuICBSZWFjdC5Db21wb25lbnRQcm9wczxcImRpdlwiPiAmIHtcbiAgICBoaWRlTGFiZWw/OiBib29sZWFuO1xuICAgIGhpZGVJbmRpY2F0b3I/OiBib29sZWFuO1xuICAgIGluZGljYXRvcj86IFwibGluZVwiIHwgXCJkb3RcIiB8IFwiZGFzaGVkXCI7XG4gICAgbmFtZUtleT86IHN0cmluZztcbiAgICBsYWJlbEtleT86IHN0cmluZztcbiAgfSkge1xuICBjb25zdCB7IGNvbmZpZyB9ID0gdXNlQ2hhcnQoKTtcblxuICBjb25zdCB0b29sdGlwTGFiZWwgPSBSZWFjdC51c2VNZW1vKCgpID0+IHtcbiAgICBpZiAoaGlkZUxhYmVsIHx8ICFwYXlsb2FkPy5sZW5ndGgpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGNvbnN0IFtpdGVtXSA9IHBheWxvYWQ7XG4gICAgY29uc3Qga2V5ID0gYCR7bGFiZWxLZXkgfHwgaXRlbT8uZGF0YUtleSB8fCBpdGVtPy5uYW1lIHx8IFwidmFsdWVcIn1gO1xuICAgIGNvbnN0IGl0ZW1Db25maWcgPSBnZXRQYXlsb2FkQ29uZmlnRnJvbVBheWxvYWQoY29uZmlnLCBpdGVtLCBrZXkpO1xuICAgIGNvbnN0IHZhbHVlID1cbiAgICAgICFsYWJlbEtleSAmJiB0eXBlb2YgbGFiZWwgPT09IFwic3RyaW5nXCJcbiAgICAgICAgPyBjb25maWdbbGFiZWwgYXMga2V5b2YgdHlwZW9mIGNvbmZpZ10/LmxhYmVsIHx8IGxhYmVsXG4gICAgICAgIDogaXRlbUNvbmZpZz8ubGFiZWw7XG5cbiAgICBpZiAobGFiZWxGb3JtYXR0ZXIpIHtcbiAgICAgIHJldHVybiAoXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPXtjbihcImZvbnQtbWVkaXVtXCIsIGxhYmVsQ2xhc3NOYW1lKX0+XG4gICAgICAgICAge2xhYmVsRm9ybWF0dGVyKHZhbHVlLCBwYXlsb2FkKX1cbiAgICAgICAgPC9kaXY+XG4gICAgICApO1xuICAgIH1cblxuICAgIGlmICghdmFsdWUpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHJldHVybiA8ZGl2IGNsYXNzTmFtZT17Y24oXCJmb250LW1lZGl1bVwiLCBsYWJlbENsYXNzTmFtZSl9Pnt2YWx1ZX08L2Rpdj47XG4gIH0sIFtcbiAgICBsYWJlbCxcbiAgICBsYWJlbEZvcm1hdHRlcixcbiAgICBwYXlsb2FkLFxuICAgIGhpZGVMYWJlbCxcbiAgICBsYWJlbENsYXNzTmFtZSxcbiAgICBjb25maWcsXG4gICAgbGFiZWxLZXksXG4gIF0pO1xuXG4gIGlmICghYWN0aXZlIHx8ICFwYXlsb2FkPy5sZW5ndGgpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIGNvbnN0IG5lc3RMYWJlbCA9IHBheWxvYWQubGVuZ3RoID09PSAxICYmIGluZGljYXRvciAhPT0gXCJkb3RcIjtcblxuICByZXR1cm4gKFxuICAgIDxkaXZcbiAgICAgIGNsYXNzTmFtZT17Y24oXG4gICAgICAgIFwiYm9yZGVyLWJvcmRlci81MCBiZy1iYWNrZ3JvdW5kIGdyaWQgbWluLXctWzhyZW1dIGl0ZW1zLXN0YXJ0IGdhcC0xLjUgcm91bmRlZC1sZyBib3JkZXIgcHgtMi41IHB5LTEuNSB0ZXh0LXhzIHNoYWRvdy14bFwiLFxuICAgICAgICBjbGFzc05hbWUsXG4gICAgICApfVxuICAgID5cbiAgICAgIHshbmVzdExhYmVsID8gdG9vbHRpcExhYmVsIDogbnVsbH1cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZCBnYXAtMS41XCI+XG4gICAgICAgIHtwYXlsb2FkXG4gICAgICAgICAgLmZpbHRlcigoaXRlbSkgPT4gaXRlbS50eXBlICE9PSBcIm5vbmVcIilcbiAgICAgICAgICAubWFwKChpdGVtLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgY29uc3Qga2V5ID0gYCR7bmFtZUtleSB8fCBpdGVtLm5hbWUgfHwgaXRlbS5kYXRhS2V5IHx8IFwidmFsdWVcIn1gO1xuICAgICAgICAgICAgY29uc3QgaXRlbUNvbmZpZyA9IGdldFBheWxvYWRDb25maWdGcm9tUGF5bG9hZChjb25maWcsIGl0ZW0sIGtleSk7XG4gICAgICAgICAgICBjb25zdCBpbmRpY2F0b3JDb2xvciA9IGNvbG9yIHx8IGl0ZW0ucGF5bG9hZC5maWxsIHx8IGl0ZW0uY29sb3I7XG5cbiAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICBrZXk9e2l0ZW0uZGF0YUtleX1cbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2NuKFxuICAgICAgICAgICAgICAgICAgXCJbJj5zdmddOnRleHQtbXV0ZWQtZm9yZWdyb3VuZCBmbGV4IHctZnVsbCBmbGV4LXdyYXAgaXRlbXMtc3RyZXRjaCBnYXAtMiBbJj5zdmddOmgtMi41IFsmPnN2Z106dy0yLjVcIixcbiAgICAgICAgICAgICAgICAgIGluZGljYXRvciA9PT0gXCJkb3RcIiAmJiBcIml0ZW1zLWNlbnRlclwiLFxuICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICB7Zm9ybWF0dGVyICYmIGl0ZW0/LnZhbHVlICE9PSB1bmRlZmluZWQgJiYgaXRlbS5uYW1lID8gKFxuICAgICAgICAgICAgICAgICAgZm9ybWF0dGVyKGl0ZW0udmFsdWUsIGl0ZW0ubmFtZSwgaXRlbSwgaW5kZXgsIGl0ZW0ucGF5bG9hZClcbiAgICAgICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAgICAgPD5cbiAgICAgICAgICAgICAgICAgICAge2l0ZW1Db25maWc/Lmljb24gPyAoXG4gICAgICAgICAgICAgICAgICAgICAgPGl0ZW1Db25maWcuaWNvbiAvPlxuICAgICAgICAgICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAgICAgICAgICFoaWRlSW5kaWNhdG9yICYmIChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtjbihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNocmluay0wIHJvdW5kZWQtWzJweF0gYm9yZGVyLSgtLWNvbG9yLWJvcmRlcikgYmctKC0tY29sb3ItYmcpXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJoLTIuNSB3LTIuNVwiOiBpbmRpY2F0b3IgPT09IFwiZG90XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInctMVwiOiBpbmRpY2F0b3IgPT09IFwibGluZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ3LTAgYm9yZGVyLVsxLjVweF0gYm9yZGVyLWRhc2hlZCBiZy10cmFuc3BhcmVudFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRpY2F0b3IgPT09IFwiZGFzaGVkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm15LTAuNVwiOiBuZXN0TGFiZWwgJiYgaW5kaWNhdG9yID09PSBcImRhc2hlZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIi0tY29sb3ItYmdcIjogaW5kaWNhdG9yQ29sb3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIi0tY29sb3ItYm9yZGVyXCI6IGluZGljYXRvckNvbG9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gYXMgUmVhY3QuQ1NTUHJvcGVydGllc1xuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17Y24oXG4gICAgICAgICAgICAgICAgICAgICAgICBcImZsZXggZmxleC0xIGp1c3RpZnktYmV0d2VlbiBsZWFkaW5nLW5vbmVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIG5lc3RMYWJlbCA/IFwiaXRlbXMtZW5kXCIgOiBcIml0ZW1zLWNlbnRlclwiLFxuICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdyaWQgZ2FwLTEuNVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAge25lc3RMYWJlbCA/IHRvb2x0aXBMYWJlbCA6IG51bGx9XG4gICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJ0ZXh0LW11dGVkLWZvcmVncm91bmRcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAge2l0ZW1Db25maWc/LmxhYmVsIHx8IGl0ZW0ubmFtZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICB7aXRlbS52YWx1ZSAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJ0ZXh0LWZvcmVncm91bmQgZm9udC1tb25vIGZvbnQtbWVkaXVtIHRhYnVsYXItbnVtc1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICB7aXRlbS52YWx1ZS50b0xvY2FsZVN0cmluZygpfVxuICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgPC8+XG4gICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApO1xuICAgICAgICAgIH0pfVxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gICk7XG59XG5cbmNvbnN0IENoYXJ0TGVnZW5kID0gUmVjaGFydHNQcmltaXRpdmUuTGVnZW5kO1xuXG5mdW5jdGlvbiBDaGFydExlZ2VuZENvbnRlbnQoe1xuICBjbGFzc05hbWUsXG4gIGhpZGVJY29uID0gZmFsc2UsXG4gIHBheWxvYWQsXG4gIHZlcnRpY2FsQWxpZ24gPSBcImJvdHRvbVwiLFxuICBuYW1lS2V5LFxufTogUmVhY3QuQ29tcG9uZW50UHJvcHM8XCJkaXZcIj4gJlxuICBQaWNrPFJlY2hhcnRzUHJpbWl0aXZlLkxlZ2VuZFByb3BzLCBcInBheWxvYWRcIiB8IFwidmVydGljYWxBbGlnblwiPiAmIHtcbiAgICBoaWRlSWNvbj86IGJvb2xlYW47XG4gICAgbmFtZUtleT86IHN0cmluZztcbiAgfSkge1xuICBjb25zdCB7IGNvbmZpZyB9ID0gdXNlQ2hhcnQoKTtcblxuICBpZiAoIXBheWxvYWQ/Lmxlbmd0aCkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgcmV0dXJuIChcbiAgICA8ZGl2XG4gICAgICBjbGFzc05hbWU9e2NuKFxuICAgICAgICBcImZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIGdhcC00XCIsXG4gICAgICAgIHZlcnRpY2FsQWxpZ24gPT09IFwidG9wXCIgPyBcInBiLTNcIiA6IFwicHQtM1wiLFxuICAgICAgICBjbGFzc05hbWUsXG4gICAgICApfVxuICAgID5cbiAgICAgIHtwYXlsb2FkXG4gICAgICAgIC5maWx0ZXIoKGl0ZW0pID0+IGl0ZW0udHlwZSAhPT0gXCJub25lXCIpXG4gICAgICAgIC5tYXAoKGl0ZW0pID0+IHtcbiAgICAgICAgICBjb25zdCBrZXkgPSBgJHtuYW1lS2V5IHx8IGl0ZW0uZGF0YUtleSB8fCBcInZhbHVlXCJ9YDtcbiAgICAgICAgICBjb25zdCBpdGVtQ29uZmlnID0gZ2V0UGF5bG9hZENvbmZpZ0Zyb21QYXlsb2FkKGNvbmZpZywgaXRlbSwga2V5KTtcblxuICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgIGtleT17aXRlbS52YWx1ZX1cbiAgICAgICAgICAgICAgY2xhc3NOYW1lPXtjbihcbiAgICAgICAgICAgICAgICBcIlsmPnN2Z106dGV4dC1tdXRlZC1mb3JlZ3JvdW5kIGZsZXggaXRlbXMtY2VudGVyIGdhcC0xLjUgWyY+c3ZnXTpoLTMgWyY+c3ZnXTp3LTNcIixcbiAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAge2l0ZW1Db25maWc/Lmljb24gJiYgIWhpZGVJY29uID8gKFxuICAgICAgICAgICAgICAgIDxpdGVtQ29uZmlnLmljb24gLz5cbiAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJoLTIgdy0yIHNocmluay0wIHJvdW5kZWQtWzJweF1cIlxuICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZENvbG9yOiBpdGVtLmNvbG9yLFxuICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICB7aXRlbUNvbmZpZz8ubGFiZWx9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICApO1xuICAgICAgICB9KX1cbiAgICA8L2Rpdj5cbiAgKTtcbn1cblxuLy8gSGVscGVyIHRvIGV4dHJhY3QgaXRlbSBjb25maWcgZnJvbSBhIHBheWxvYWQuXG5mdW5jdGlvbiBnZXRQYXlsb2FkQ29uZmlnRnJvbVBheWxvYWQoXG4gIGNvbmZpZzogQ2hhcnRDb25maWcsXG4gIHBheWxvYWQ6IHVua25vd24sXG4gIGtleTogc3RyaW5nLFxuKSB7XG4gIGlmICh0eXBlb2YgcGF5bG9hZCAhPT0gXCJvYmplY3RcIiB8fCBwYXlsb2FkID09PSBudWxsKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuXG4gIGNvbnN0IHBheWxvYWRQYXlsb2FkID1cbiAgICBcInBheWxvYWRcIiBpbiBwYXlsb2FkICYmXG4gICAgdHlwZW9mIHBheWxvYWQucGF5bG9hZCA9PT0gXCJvYmplY3RcIiAmJlxuICAgIHBheWxvYWQucGF5bG9hZCAhPT0gbnVsbFxuICAgICAgPyBwYXlsb2FkLnBheWxvYWRcbiAgICAgIDogdW5kZWZpbmVkO1xuXG4gIGxldCBjb25maWdMYWJlbEtleTogc3RyaW5nID0ga2V5O1xuXG4gIGlmIChcbiAgICBrZXkgaW4gcGF5bG9hZCAmJlxuICAgIHR5cGVvZiBwYXlsb2FkW2tleSBhcyBrZXlvZiB0eXBlb2YgcGF5bG9hZF0gPT09IFwic3RyaW5nXCJcbiAgKSB7XG4gICAgY29uZmlnTGFiZWxLZXkgPSBwYXlsb2FkW2tleSBhcyBrZXlvZiB0eXBlb2YgcGF5bG9hZF0gYXMgc3RyaW5nO1xuICB9IGVsc2UgaWYgKFxuICAgIHBheWxvYWRQYXlsb2FkICYmXG4gICAga2V5IGluIHBheWxvYWRQYXlsb2FkICYmXG4gICAgdHlwZW9mIHBheWxvYWRQYXlsb2FkW2tleSBhcyBrZXlvZiB0eXBlb2YgcGF5bG9hZFBheWxvYWRdID09PSBcInN0cmluZ1wiXG4gICkge1xuICAgIGNvbmZpZ0xhYmVsS2V5ID0gcGF5bG9hZFBheWxvYWRbXG4gICAgICBrZXkgYXMga2V5b2YgdHlwZW9mIHBheWxvYWRQYXlsb2FkXG4gICAgXSBhcyBzdHJpbmc7XG4gIH1cblxuICByZXR1cm4gY29uZmlnTGFiZWxLZXkgaW4gY29uZmlnXG4gICAgPyBjb25maWdbY29uZmlnTGFiZWxLZXldXG4gICAgOiBjb25maWdba2V5IGFzIGtleW9mIHR5cGVvZiBjb25maWddO1xufVxuXG5leHBvcnQge1xuICBDaGFydENvbnRhaW5lcixcbiAgQ2hhcnRUb29sdGlwLFxuICBDaGFydFRvb2x0aXBDb250ZW50LFxuICBDaGFydExlZ2VuZCxcbiAgQ2hhcnRMZWdlbmRDb250ZW50LFxuICBDaGFydFN0eWxlLFxufTtcbiJdfQ==