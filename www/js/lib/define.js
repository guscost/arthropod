// Custom AMD-like loader, does not support circular dependencies
const __MODULES__ = {
    cache: {},
    pending: {},
    hasCycle: false,
    checkCycles: () => {
        const visited = new Set();
        const recursionStack = new Set();
        // Recursive depth-first search to trace dependency cycles
        function trace(module) {
            var _a;
            if (recursionStack.has(module)) {
                return [module];
            }
            if (visited.has(module)) {
                return [];
            }
            visited.add(module);
            recursionStack.add(module);
            const deps = ((_a = __MODULES__.pending[module]) === null || _a === void 0 ? void 0 : _a.unmetDeps) || [];
            for (const dep of deps) {
                const cycle = trace(dep);
                if (cycle.length > 0) {
                    cycle.push(module);
                    return cycle;
                }
            }
            recursionStack.delete(module);
            return [];
        }
        for (const module of Object.keys(__MODULES__.pending)) {
            if (!visited.has(module)) {
                const cycle = trace(module);
                if (cycle.length > 0) {
                    __MODULES__.hasCycle = true;
                    const firstNode = cycle[0];
                    const lastIndex = cycle.lastIndexOf(firstNode);
                    const minimalCycle = cycle.slice(0, lastIndex + 1);
                    throw new Error("Circular dependency " + minimalCycle.reverse().join(" -> "));
                }
            }
        }
    },
    get: (name) => __MODULES__.cache[name],
    set: (name, value) => (__MODULES__.cache[name] = value),
    resolve: (name, from) => {
        if (/^\.\.?\//.test(name)) {
            const absolutePath = from.split("/").slice(0, -1);
            const relativeDep = name.split("/");
            while (relativeDep[0] === "..") {
                relativeDep.shift();
                absolutePath.pop();
            }
            while (relativeDep[0] === ".") {
                relativeDep.shift();
            }
            name = [...absolutePath, ...relativeDep].join("/");
        }
        else {
            name = name.replace(/^@?\//, __ROOT_PATH__ + "/js/");
        }
        return name;
    },
    refresh: () => {
        if (__MODULES__.hasCycle)
            return;
        for (const [key, { unmetDeps, load }] of Object.entries(__MODULES__.pending)) {
            if (unmetDeps.every((name) => name in __MODULES__.cache)) {
                delete __MODULES__.pending[key];
                load();
            }
        }
        __MODULES__.checkCycles();
    },
};
const define = (...args) => {
    let name, deps, factory;
    // Webpack AMD modules are named, TypeScript AMD modules are not
    if ("string" === typeof args[0]) {
        name = args[0];
        deps = args[1];
        factory = args[2];
    }
    else {
        name = document.currentScript.src
            .replace(document.location.origin, "")
            .replace(/\.js$/, "");
        deps = args[0];
        factory = args[1];
    }
    // TypeScript AMD modules pass in require and exports
    if ("require" === deps[0] && "exports" === deps[1]) {
        deps = deps.slice(2);
        const load = () => {
            const require = (dep) => __MODULES__.get(__MODULES__.resolve(dep, name));
            const exports = {};
            factory.call(this, require, exports, ...deps.map(require));
            __MODULES__.set(name, exports);
            __MODULES__.refresh();
        };
        const unmetDeps = [];
        for (let dep of deps) {
            dep = __MODULES__.resolve(dep, name);
            !__MODULES__.get(dep) && unmetDeps.push(dep);
        }
        for (let dep of unmetDeps) {
            if (!Object.values(__MODULES__.pending).some(({ unmetDeps }) => unmetDeps.includes(dep))) {
                __LOAD_SCRIPT__(dep, true);
            }
        }
        __MODULES__.pending[name] = { unmetDeps, load };
        __MODULES__.refresh();
    }
    else {
        // Webpack UMDs do not load dynamically, add these script tags in order
        __MODULES__.set(name, factory.call(this, ...deps.map(__MODULES__.get)));
    }
};
define.amd = true; // lol no it's not, but pretend we are AMD/RequireJS
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGVmaW5lLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2xpYi9kZWZpbmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsaUVBQWlFO0FBQ2pFLE1BQU0sV0FBVyxHQVNiO0lBQ0YsS0FBSyxFQUFFLEVBQUU7SUFDVCxPQUFPLEVBQUUsRUFBRTtJQUNYLFFBQVEsRUFBRSxLQUFLO0lBQ2YsV0FBVyxFQUFFLEdBQUcsRUFBRTtRQUNoQixNQUFNLE9BQU8sR0FBRyxJQUFJLEdBQUcsRUFBVSxDQUFDO1FBQ2xDLE1BQU0sY0FBYyxHQUFHLElBQUksR0FBRyxFQUFVLENBQUM7UUFFekMsMERBQTBEO1FBQzFELFNBQVMsS0FBSyxDQUFDLE1BQWM7O1lBQzNCLElBQUksY0FBYyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDO2dCQUMvQixPQUFPLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDbEIsQ0FBQztZQUNELElBQUksT0FBTyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDO2dCQUN4QixPQUFPLEVBQUUsQ0FBQztZQUNaLENBQUM7WUFFRCxPQUFPLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBQ3BCLGNBQWMsQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUM7WUFFM0IsTUFBTSxJQUFJLEdBQUcsQ0FBQSxNQUFBLFdBQVcsQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLDBDQUFFLFNBQVMsS0FBSSxFQUFFLENBQUM7WUFDMUQsS0FBSyxNQUFNLEdBQUcsSUFBSSxJQUFJLEVBQUUsQ0FBQztnQkFDdkIsTUFBTSxLQUFLLEdBQUcsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO2dCQUN6QixJQUFJLEtBQUssQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFLENBQUM7b0JBQ3JCLEtBQUssQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7b0JBQ25CLE9BQU8sS0FBSyxDQUFDO2dCQUNm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QUN2RSxXQUFXLENBQUMsR0FBRyxDQUFDLElBQUksRUFBRSxPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUMxRSxDQUFDO0FBQ0gsQ0FBQyxDQUFDO0FBRUYsTUFBTSxDQUFDLEdBQUcsR0FBRyxJQUFJLENBQUMsQ0FBQyxvREFBb0QiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDdXN0b20gQU1ELWxpa2UgbG9hZGVyLCBkb2VzIG5vdCBzdXBwb3J0IGNpcmN1bGFyIGRlcGVuZGVuY2llc1xuY29uc3QgX19NT0RVTEVTX186IHtcbiAgY2FjaGU6IHsgW25hbWU6IHN0cmluZ106IGFueSB9O1xuICBwZW5kaW5nOiB7IFtuYW1lOiBzdHJpbmddOiB7IHVubWV0RGVwczogc3RyaW5nW107IGxvYWQ6ICgpID0+IHZvaWQgfSB9O1xuICBoYXNDeWNsZTogYm9vbGVhbjtcbiAgY2hlY2tDeWNsZXM6ICgpID0+IHZvaWQ7XG4gIGdldDogKG5hbWU6IHN0cmluZykgPT4gYW55O1xuICBzZXQ6IChuYW1lOiBzdHJpbmcsIHZhbHVlOiBhbnkpID0+IHZvaWQ7XG4gIHJlc29sdmU6IChkZXA6IHN0cmluZywgY3VycmVudDogc3RyaW5nKSA9PiBzdHJpbmc7XG4gIHJlZnJlc2g6ICgpID0+IHZvaWQ7XG59ID0ge1xuICBjYWNoZToge30sXG4gIHBlbmRpbmc6IHt9LFxuICBoYXNDeWNsZTogZmFsc2UsXG4gIGNoZWNrQ3ljbGVzOiAoKSA9PiB7XG4gICAgY29uc3QgdmlzaXRlZCA9IG5ldyBTZXQ8c3RyaW5nPigpO1xuICAgIGNvbnN0IHJlY3Vyc2lvblN0YWNrID0gbmV3IFNldDxzdHJpbmc+KCk7XG5cbiAgICAvLyBSZWN1cnNpdmUgZGVwdGgtZmlyc3Qgc2VhcmNoIHRvIHRyYWNlIGRlcGVuZGVuY3kgY3ljbGVzXG4gICAgZnVuY3Rpb24gdHJhY2UobW9kdWxlOiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgICBpZiAocmVjdXJzaW9uU3RhY2suaGFzKG1vZHVsZSkpIHtcbiAgICAgICAgcmV0dXJuIFttb2R1bGVdO1xuICAgICAgfVxuICAgICAgaWYgKHZpc2l0ZWQuaGFzKG1vZHVsZSkpIHtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgfVxuXG4gICAgICB2aXNpdGVkLmFkZChtb2R1bGUpO1xuICAgICAgcmVjdXJzaW9uU3RhY2suYWRkKG1vZHVsZSk7XG5cbiAgICAgIGNvbnN0IGRlcHMgPSBfX01PRFVMRVNfXy5wZW5kaW5nW21vZHVsZV0/LnVubWV0RGVwcyB8fCBbXTtcbiAgICAgIGZvciAoY29uc3QgZGVwIG9mIGRlcHMpIHtcbiAgICAgICAgY29uc3QgY3ljbGUgPSB0cmFjZShkZXApO1xuICAgICAgICBpZiAoY3ljbGUubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGN5Y2xlLnB1c2gobW9kdWxlKTtcbiAgICAgICAgICByZXR1cm4gY3ljbGU7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmVjdXJzaW9uU3RhY2suZGVsZXRlKG1vZHVsZSk7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuXG4gICAgZm9yIChjb25zdCBtb2R1bGUgb2YgT2JqZWN0LmtleXMoX19NT0RVTEVTX18ucGVuZGluZykpIHtcbiAgICAgIGlmICghdmlzaXRlZC5oYXMobW9kdWxlKSkge1xuICAgICAgICBjb25zdCBjeWNsZSA9IHRyYWNlKG1vZHVsZSk7XG5cbiAgICAgICAgaWYgKGN5Y2xlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBfX01PRFVMRVNfXy5oYXNDeWNsZSA9IHRydWU7XG4gICAgICAgICAgY29uc3QgZmlyc3ROb2RlID0gY3ljbGVbMF07XG4gICAgICAgICAgY29uc3QgbGFzdEluZGV4ID0gY3ljbGUubGFzdEluZGV4T2YoZmlyc3ROb2RlKTtcbiAgICAgICAgICBjb25zdCBtaW5pbWFsQ3ljbGUgPSBjeWNsZS5zbGljZSgwLCBsYXN0SW5kZXggKyAxKTtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgICBcIkNpcmN1bGFyIGRlcGVuZGVuY3kgXCIgKyBtaW5pbWFsQ3ljbGUucmV2ZXJzZSgpLmpvaW4oXCIgLT4gXCIpLFxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGdldDogKG5hbWU6IHN0cmluZykgPT4gX19NT0RVTEVTX18uY2FjaGVbbmFtZV0sXG4gIHNldDogKG5hbWU6IHN0cmluZywgdmFsdWU6IGFueSkgPT4gKF9fTU9EVUxFU19fLmNhY2hlW25hbWVdID0gdmFsdWUpLFxuICByZXNvbHZlOiAobmFtZTogc3RyaW5nLCBmcm9tOiBzdHJpbmcpID0+IHtcbiAgICBpZiAoL15cXC5cXC4/XFwvLy50ZXN0KG5hbWUpKSB7XG4gICAgICBjb25zdCBhYnNvbHV0ZVBhdGggPSBmcm9tLnNwbGl0KFwiL1wiKS5zbGljZSgwLCAtMSk7XG4gICAgICBjb25zdCByZWxhdGl2ZURlcCA9IG5hbWUuc3BsaXQoXCIvXCIpO1xuICAgICAgd2hpbGUgKHJlbGF0aXZlRGVwWzBdID09PSBcIi4uXCIpIHtcbiAgICAgICAgcmVsYXRpdmVEZXAuc2hpZnQoKTtcbiAgICAgICAgYWJzb2x1dGVQYXRoLnBvcCgpO1xuICAgICAgfVxuICAgICAgd2hpbGUgKHJlbGF0aXZlRGVwWzBdID09PSBcIi5cIikge1xuICAgICAgICByZWxhdGl2ZURlcC5zaGlmdCgpO1xuICAgICAgfVxuICAgICAgbmFtZSA9IFsuLi5hYnNvbHV0ZVBhdGgsIC4uLnJlbGF0aXZlRGVwXS5qb2luKFwiL1wiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgbmFtZSA9IG5hbWUucmVwbGFjZSgvXkA/XFwvLywgX19ST09UX1BBVEhfXyArIFwiL2pzL1wiKTtcbiAgICB9XG4gICAgcmV0dXJuIG5hbWU7XG4gIH0sXG4gIHJlZnJlc2g6ICgpID0+IHtcbiAgICBpZiAoX19NT0RVTEVTX18uaGFzQ3ljbGUpIHJldHVybjtcbiAgICBmb3IgKGNvbnN0IFtrZXksIHsgdW5tZXREZXBzLCBsb2FkIH1dIG9mIE9iamVjdC5lbnRyaWVzKFxuICAgICAgX19NT0RVTEVTX18ucGVuZGluZyxcbiAgICApKSB7XG4gICAgICBpZiAodW5tZXREZXBzLmV2ZXJ5KChuYW1lKSA9PiBuYW1lIGluIF9fTU9EVUxFU19fLmNhY2hlKSkge1xuICAgICAgICBkZWxldGUgX19NT0RVTEVTX18ucGVuZGluZ1trZXldO1xuICAgICAgICBsb2FkKCk7XG4gICAgICB9XG4gICAgfVxuICAgIF9fTU9EVUxFU19fLmNoZWNrQ3ljbGVzKCk7XG4gIH0sXG59O1xuXG5jb25zdCBkZWZpbmUgPSAoLi4uYXJnczogYW55KSA9PiB7XG4gIGxldCBuYW1lOiBzdHJpbmcsIGRlcHM6IEFycmF5PHN0cmluZz4sIGZhY3Rvcnk6IEZ1bmN0aW9uO1xuXG4gIC8vIFdlYnBhY2sgQU1EIG1vZHVsZXMgYXJlIG5hbWVkLCBUeXBlU2NyaXB0IEFNRCBtb2R1bGVzIGFyZSBub3RcbiAgaWYgKFwic3RyaW5nXCIgPT09IHR5cGVvZiBhcmdzWzBdKSB7XG4gICAgbmFtZSA9IGFyZ3NbMF07XG4gICAgZGVwcyA9IGFyZ3NbMV07XG4gICAgZmFjdG9yeSA9IGFyZ3NbMl07XG4gIH0gZWxzZSB7XG4gICAgbmFtZSA9IChkb2N1bWVudC5jdXJyZW50U2NyaXB0IGFzIEhUTUxTY3JpcHRFbGVtZW50KS5zcmNcbiAgICAgIC5yZXBsYWNlKGRvY3VtZW50LmxvY2F0aW9uLm9yaWdpbiwgXCJcIilcbiAgICAgIC5yZXBsYWNlKC9cXC5qcyQvLCBcIlwiKTtcbiAgICBkZXBzID0gYXJnc1swXTtcbiAgICBmYWN0b3J5ID0gYXJnc1sxXTtcbiAgfVxuXG4gIC8vIFR5cGVTY3JpcHQgQU1EIG1vZHVsZXMgcGFzcyBpbiByZXF1aXJlIGFuZCBleHBvcnRzXG4gIGlmIChcInJlcXVpcmVcIiA9PT0gZGVwc1swXSAmJiBcImV4cG9ydHNcIiA9PT0gZGVwc1sxXSkge1xuICAgIGRlcHMgPSBkZXBzLnNsaWNlKDIpO1xuXG4gICAgY29uc3QgbG9hZCA9ICgpID0+IHtcbiAgICAgIGNvbnN0IHJlcXVpcmUgPSAoZGVwOiBzdHJpbmcpID0+XG4gICAgICAgIF9fTU9EVUxFU19fLmdldChfX01PRFVMRVNfXy5yZXNvbHZlKGRlcCwgbmFtZSkpO1xuICAgICAgY29uc3QgZXhwb3J0cyA9IHt9O1xuICAgICAgZmFjdG9yeS5jYWxsKHRoaXMsIHJlcXVpcmUsIGV4cG9ydHMsIC4uLmRlcHMubWFwKHJlcXVpcmUpKTtcbiAgICAgIF9fTU9EVUxFU19fLnNldChuYW1lLCBleHBvcnRzKTtcbiAgICAgIF9fTU9EVUxFU19fLnJlZnJlc2goKTtcbiAgICB9O1xuXG4gICAgY29uc3QgdW5tZXREZXBzID0gW107XG4gICAgZm9yIChsZXQgZGVwIG9mIGRlcHMpIHtcbiAgICAgIGRlcCA9IF9fTU9EVUxFU19fLnJlc29sdmUoZGVwLCBuYW1lKTtcbiAgICAgICFfX01PRFVMRVNfXy5nZXQoZGVwKSAmJiB1bm1ldERlcHMucHVzaChkZXApO1xuICAgIH1cblxuICAgIGZvciAobGV0IGRlcCBvZiB1bm1ldERlcHMpIHtcbiAgICAgIGlmIChcbiAgICAgICAgIU9iamVjdC52YWx1ZXMoX19NT0RVTEVTX18ucGVuZGluZykuc29tZSgoeyB1bm1ldERlcHMgfSkgPT5cbiAgICAgICAgICB1bm1ldERlcHMuaW5jbHVkZXMoZGVwKSxcbiAgICAgICAgKVxuICAgICAgKSB7XG4gICAgICAgIF9fTE9BRF9TQ1JJUFRfXyhkZXAsIHRydWUpO1xuICAgICAgfVxuICAgIH1cblxuICAgIF9fTU9EVUxFU19fLnBlbmRpbmdbbmFtZV0gPSB7IHVubWV0RGVwcywgbG9hZCB9O1xuICAgIF9fTU9EVUxFU19fLnJlZnJlc2goKTtcbiAgfSBlbHNlIHtcbiAgICAvLyBXZWJwYWNrIFVNRHMgZG8gbm90IGxvYWQgZHluYW1pY2FsbHksIGFkZCB0aGVzZSBzY3JpcHQgdGFncyBpbiBvcmRlclxuICAgIF9fTU9EVUxFU19fLnNldChuYW1lLCBmYWN0b3J5LmNhbGwodGhpcywgLi4uZGVwcy5tYXAoX19NT0RVTEVTX18uZ2V0KSkpO1xuICB9XG59O1xuXG5kZWZpbmUuYW1kID0gdHJ1ZTsgLy8gbG9sIG5vIGl0J3Mgbm90LCBidXQgcHJldGVuZCB3ZSBhcmUgQU1EL1JlcXVpcmVKU1xuIl19